<h1>Zuordnung Fragen zu Listen</h1>

<p *ngIf="!mappings"><em>Loading...</em></p>

<table class='table' *ngIf="mappings">
  <thead>
    <tr>
      <th>Abschnitt</th>
      <th>Frage</th>
      <th>Antwort</th>
      <th>Liste</th>
      <th>Partner</th>
      <th>Leader</th>
      <th>Follower</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let mapping of mappings">
      <td>{{ mapping.section }}</td>
      <td>{{ mapping.question }}</td>
      <td>{{ mapping.answer }}</td>
      <td><a [routerLink]="['/', getEventAcronym(), 'registrables', mapping.registrableId, 'participants']">{{ mapping.registrableName }}</a></td>
      <td>
        <select [(ngModel)]="mapping.questionId_Partner" *ngIf="mapping.isPartnerRegistrable" style="max-width: 300px" (change)="changeMappingAttribute(mapping)">
          <option *ngFor="let question of questions" value={{question.id}}>{{ question.section }} / {{ question.question }}</option>
        </select>
      </td>
      <td>
        <select [(ngModel)]="mapping.questionOptionId_Leader" *ngIf="mapping.isPartnerRegistrable" style="max-width: 300px" (change)="changeMappingAttribute(mapping)">
          <option *ngFor="let questionOption of unassignedQuestionOptions" value={{questionOption.questionOptionId}}>{{ questionOption.section }} / {{ questionOption.question }} / {{ questionOption.answer }}</option>
        </select>
      </td>
      <td>
        <select [(ngModel)]="mapping.questionOptionId_Follower" *ngIf="mapping.isPartnerRegistrable" style="max-width: 300px" (change)="changeMappingAttribute(mapping)">
          <option *ngFor="let questionOption of unassignedQuestionOptions" value={{questionOption.questionOptionId}}>{{ questionOption.section }} / {{ questionOption.question }} / {{ questionOption.answer }}</option>
        </select>
      </td>
      <td>
        <button class="btn btn-sm btn-primary" (click)="saveMapping(mapping)" *ngIf="mapping.saveAttributesPending">Speichern</button>
        <button class="btn btn-sm btn-primary" (click)="removeMapping(mapping.questionOptionId, mapping.registrableId)" *ngIf="!mapping.saveAttributesPending">LÃ¶schen</button>
      </td>
    </tr>
  </tbody>
</table>

<h2>Nicht zugeordnete Antwortoptionen</h2>
<table class='table' *ngIf="unassignedQuestionOptions">
  <thead>
    <tr>
      <th>Abschnitt</th>
      <th>Frage</th>
      <th>Antwort</th>
      <th>Zuordnung</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let unassignedQuestionOption of unassignedQuestionOptions">
      <td>{{ unassignedQuestionOption.section }}</td>
      <td>{{ unassignedQuestionOption.question }}</td>
      <td>{{ unassignedQuestionOption.answer }}</td>
      <td class="col-md-2">
        <ng-multiselect-dropdown [placeholder]="'Zuordnung'"
                                 [data]="registrables"
                                 [(ngModel)]="unassignedQuestionOption.assignedRegistrableIds"
                                 [settings]="dropdownSettings"
                                 (onSelect)="onItemSelect($event, unassignedQuestionOption)"
                                 (onDeSelect)="onItemDeselect($event, unassignedQuestionOption)">
        </ng-multiselect-dropdown>
      </td>
    </tr>
  </tbody>
</table>
